<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://www.unpkg.com/axios@1.3.5/dist/axios.min.js"></script>
</head>
<body>
    <img id="img"/>
    <script>
        const p1 = new Promise((resolve, reject) => {
            axios.get('http://localhost:8080/client1/GTAV.png', {
                headers: {
                    Range: 'bytes=0-300000',
                    Authorization: 'Basic Y2xpZW50MToxMjM='
                }
            }).then((res) => {
            }).catch((err) => {
                console.log(err);
            })
        })
        const p2 = new Promise((resolve, reject) => {
            axios.get('http://localhost:8080/client1/GTAV.png', {
                headers: {
                    Range: 'bytes=300001-',
                    Authorization: 'Basic Y2xpZW50MToxMjM='
                }
            }).then((res) => {
            }).catch((err) => {
                console.log(err);
            })
        })



        Promise.all([p1, p2])
            .then((responses) => {
                const [response1, response2] = responses;
                const mergedArrayBuffer = appendBuffer(response1.data, response2.data);

                // 将合并后的数据转换成 Blob 对象
                const mergedBlob = new Blob([mergedArrayBuffer], { type: 'image/png' });

                // 创建一个 URL 对象用于显示图片
                const url = URL.createObjectURL(mergedBlob);

                // 设置图片的 src 属性为合并后的图片 URL
                document.getElementById('img').src = url;
            })
            .catch((errors) => {
                console.log(errors);
            });

        // 辅助函数：将两个 ArrayBuffer 合并成一个
        function appendBuffer(buffer1, buffer2) {
            const tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);
            tmp.set(new Uint8Array(buffer1), 0);
            tmp.set(new Uint8Array(buffer2), buffer1.byteLength);
            return tmp.buffer;
        }
    </script>
</body>
</html>
